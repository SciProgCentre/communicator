### Обмен сообщениями

----

### Прокси-сервер

Имеем ROUTER сокет к клиентам.
Имеем ROUTER сокет к воркерам.

----

#### Получаем от клиента

Первая часть сообщения - identity клиента (автоматически добавляется ROUTER сокетом)
Вторая часть сообщения - UTF-8 строка, тип сообщения.

QUERY: Запрос на вычисление функции.

 - ID запроса (UUID, генерируется клиентом)
 - Аргумент запроса (байтовый блок)
 - Название функции (строка)

CODER_IDENTITY_QUERY: Запрос на получение identity кодеров для функции

 - ID запроса
 - Название функции (строка)
 
RESPONSE_RECEIVED: Сообщение о том, что ответ на запрос получен.
 
 - ID запроса
 
----

#### Отправляем клиенту

Первая часть сообщения - identity клиента (автоматически удаляется ROUTER сокетом)
Вторая часть сообщения - UTF-8 строка, тип сообщения.

RESPONSE_RESULT: Ответ на запрос - завершен успешно

 - ID запроса
 - Результат запроса (байтовый блок)
 
RESPONSE_EXCEPTION: Ответ на запрос - ошибка RemoteFunctionException (см. файл Exceptions.kt)

- ID запроса
- Строка remoteExceptionMessage (сообщение эксепшена, который бросила удаленная функция. можно оставить пустым, если в языке нет exception.toString)

RESPONSE_UNKNOWN_FUNCTION: Ответ на запрос - ошибка UnsupportedFunctionNameException
- ID запроса
- Строка functionName
 
CODER_IDENTITY_FOUND: Ответ на запрос identity кодеров функции - функция поддерживается

 - ID запроса
 - Identity кодера аргумента (строка)
 - Identity кодера результата (строка)
 
CODER_IDENTITY_NOT_FOUND: Ответ на запрос identity кодеров функции - функция не поддерживается

 - ID запроса
 
QUERY_RECEIVED: Сообщение о том, что запрос получен сервером.

 - ID запроса (16 байтов)
 
----

#### Получаем от воркера

Первая часть сообщения - identity воркера (автоматически добавляется ROUTER сокетом)
Вторая часть сообщения - UTF-8 строка, тип сообщения.

RESPONSE_RESULT: Ответ на запрос - завершен успешно

 - ID запроса
 - Результат запроса (байтовый блок)
 
RESPONSE_EXCEPTION: Ответ на запрос - ошибка RemoteFunctionException (см. файл Exceptions.kt)

- ID запроса
- Строка remoteExceptionMessage (сообщение эксепшена, который бросила удаленная функция. можно оставить пустым, если в языке нет exception.toString)

QUERY_RECEIVED: Сообщение о том, что запрос получен воркером.

 - ID запроса (16 байтов)
 
HEART_BEAT: Heart beat (зарезервировано)

 - Нет дополнительных частей

WORKER_REGISTER: Запрос воркера на подключение к прокси и передача информации о всех кодерах

- Кол-во функций (4 байта)
- Далее для каждой из функций одна часть - название, вторая часть - identity кодера аргумента, третья часть - identity кодера результата

----

#### Отправляем воркеру

Первая часть сообщения - identity воркера (автоматически удаляется ROUTER сокетом)
Вторая часть сообщения - UTF-8 строка, тип сообщения

QUERY: Запрос на вычисление функции.

 - ID запроса
 - Аргумент запроса (байтовый блок)
 - Название функции (строка)
 
RESPONSE_RECEIVED: Сообщение о том, что ответ на запрос получен.
 
 - ID запроса
 
INCOMPATIBLE_SPECS_FAILURE: Сообщение о том, что один из кодеров воркера отличается от тех, которые уже есть у других воркеров
(ошибка IncompatibleSpecsException).

 - Название функции
 - Identity кодера аргумента у других воркеров
 - Identity кодера результата у других воркеров

----